<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>多CDN视频播放器</title>
    
    <!-- Font Awesome CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" 
          integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eGBvH0H/ZpiBw==" 
          crossorigin="anonymous" referrerpolicy="no-referrer" />

    <style>
        /* 保持原有样式不变，新增CDN状态指示 */
        .cdn-status {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 12px;
            z-index: 100;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>📺 多CDN视频播放器</h1>
        <div class="player-wrapper">
            <div class="loading">
                <i class="fas fa-spinner fa-spin"></i>
            </div>
            <div class="error-message" id="errorMsg"></div>
            <div class="cdn-status" id="cdnStatus">正在连接CDN...</div>
            
            <!-- 四源播放方案 -->
            <video id="mainVideo" controls playsinline>
                <!-- CDN源优先级排序 -->
                <source data-cdn="jsDelivr" 
                        src="https://cdn.jsdelivr.net/gh/lengwuya/shipin-/main/shipin.mp4" 
                        type="video/mp4">
                
                <source data-cdn="GitHack" 
                        src="https://raw.githack.com/lengwuya/shipin-/main/shipin.mp4" 
                        type="video/mp4">
                
                <source data-cdn="FastGit" 
                        src="https://raw.fastgit.org/lengwuya/shipin-/main/shipin.mp4" 
                        type="video/mp4">
                
                <source data-cdn="GitHub" 
                        src="shipin.mp4" 
                        type="video/mp4">

                您的浏览器不支持视频播放，请使用现代浏览器访问
            </video>
            
            <!-- 控制栏保持不变 -->
        </div>
    </div>

    <script>
        // 多CDN智能切换系统
        const video = document.getElementById('mainVideo');
        const cdnStatus = document.getElementById('cdnStatus');
        const sources = Array.from(video.querySelectorAll('source'));
        let currentSourceIndex = 0;

        // 自动检测可用CDN
        function tryNextSource() {
            currentSourceIndex++;
            if (currentSourceIndex >= sources.length) {
                showFinalError();
                return;
            }

            const newSource = sources[currentSourceIndex];
            cdnStatus.textContent = `正在尝试 ${newSource.dataset.cdn}...`;
            video.src = newSource.src;
            video.load();
            video.play().catch(e => {
                setTimeout(tryNextSource, 1500);
            });
        }

        // 增强错误处理
        video.addEventListener('error', function() {
            if (video.error.code === 4) { // MEDIA_ERR_SRC_NOT_SUPPORTED
                tryNextSource();
            }
        });

        // 成功加载时显示CDN信息
        video.addEventListener('play', () => {
            cdnStatus.textContent = `当前CDN: ${sources[currentSourceIndex].dataset.cdn}`;
            cdnStatus.style.backgroundColor = '#4CAF50';
        });

        // 初始化自动播放检测
        video.play().catch(e => {
            cdnStatus.textContent = '首次加载可能需要等待CDN响应...';
            tryNextSource();
        });

        // 其他控制逻辑保持不变...
    </script>
</body>
</html>
