<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <!-- iOS核心优化标签[1,3](@ref) -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <!-- 预加载关键资源[6](@ref) -->
    <link rel="preload" href="video.mp4" as="video" type="video/mp4">
    
    <title>优化版移动端页面</title>
    
    <style>
        /* 基础重置[3,7](@ref) */
        * {
            margin: 0;
            padding: 0;
            -webkit-tap-highlight-color: transparent;
        }
        
        /* 媒体容器定位[1,7](@ref) */
        .media-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 100vw;
            height: 56.25vw; /* 16:9比例 */
            max-height: 100vh;
            background: #000;
        }
        
        /* 硬件加速优化[3,7](@ref) */
        video {
            width: 100%;
            height: 100%;
            object-fit: contain;
            transform: translateZ(0);
            backface-visibility: hidden;
        }
        
        /* 播放按钮样式[3](@ref) */
        .play-btn {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: rgba(255,255,255,0.8);
            border: none;
            opacity: 0;
            transition: opacity 0.3s;
        }
        .play-btn.active {
            opacity: 1;
        }
    </style>
    
    <!-- 微信JS-SDK支持[1](@ref) -->
    <script src="https://res.wx.qq.com/open/js/jweixin-1.6.0.js"></script>
</head>
<body>
    <!-- 视频容器[1,7](@ref) -->
    <div class="media-container">
        <video 
            id="mainVideo"
            webkit-playsinline="true"
            playsinline
            muted
            preload="metadata"
            poster="poster.jpg">
            <source src="video.mp4" type="video/mp4">
            <source src="video.webm" type="video/webm">
            <p>您的浏览器不支持视频播放</p>
        </video>
        <button class="play-btn" id="playBtn">▶</button>
    </div>

    <script>
        // 自动播放处理[1,3](@ref)
        document.addEventListener('DOMContentLoaded', function() {
            const video = document.getElementById('mainVideo');
            const playBtn = document.getElementById('playBtn');
            
            // 微信环境适配[1](@ref)
            if (typeof WeixinJSBridge !== 'undefined') {
                WeixinJSBridge.invoke('getNetworkType', {}, () => {
                    video.play().catch(() => showPlayButton());
                });
            } else {
                // 自动播放尝试[3](@ref)
                const playPromise = video.play();
                if (playPromise !== undefined) {
                    playPromise.catch(() => showPlayButton());
                }
            }

            // 用户交互处理[7](@ref)
            playBtn.addEventListener('click', () => {
                video.muted = false;
                video.play();
                playBtn.classList.remove('active');
            });

            function showPlayButton() {
                playBtn.classList.add('active');
            }
        });

        // 可视状态检测[6](@ref)
        document.addEventListener('visibilitychange', () => {
            if (document.hidden) {
                video.pause();
            } else {
                video.play().catch(() => {});
            }
        });
    </script>
</body>
</html>
